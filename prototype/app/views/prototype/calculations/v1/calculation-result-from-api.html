{% extends "layouts/main.html" %} 
{% set pageName="Calculation Factors - Data MVP" %}
{% set fallbackPage="javascript:history.back()" %}

{% block beforeContent %} 
{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %} 
{{ govukBreadcrumbs({ items: [ { text: "Home", href: "javascript:history.back()" }, { text: "Allocation statements - Calculations", href: "javascript:history.back()" } ] }) }} 
{% endblock %} 

{% block content %}

    <div class="govuk-grid-column-full">
    <span class="govuk-caption-l">Published: 12 Feb 2026. <span><strong>Version 1 </strong></span><span><strong class="govuk-tag" style="display: inline; margin-left: 5px;">Latest</strong></span></span>
    <h1 class="govuk-heading-xl">16-19 for academic year 2026 to 2027</h1>
    <h2 class="govuk-caption-l">Total allocation</h2>
    <span class="govuk-heading-l">Â£1,150,000</span>
    {% from "govuk/components/table/macro.njk" import govukTable %}
    {{ govukTable({
    caption: "Summary allocation",
    captionClasses: "govuk-table__caption--m",
    classes: "govuk-!-margin-bottom-9",
    firstCellIsHeader: true,
    head: [
    {
    text: "High Needs Funding"
    },
    {
    text: "Current Total",
    format: "numeric"
    }
    ],
    rows: calculationresult.fundingTemplate.fundingLines | asfundingLinesRows

    }) }}
  </div>

<div class="govuk-grid-row">
    
  <div class="govuk-grid-column-full">
    <span class="govuk-caption-l">Data Driven Calculation Dataset <span><strong>Version 1</strong></span><span><strong class="govuk-tag" style="display: inline; margin-left: 5px;">Latest</strong></span></span>
    <h4 class="govuk-caption-1">Dataset created by downloading and combining real data from CFS' Database(s), for the purpose of proving technical feasability</h4>

    {# --- START OF JSON DETAILS COMPONENT --- #}
    {% from "govuk/components/details/macro.njk" import govukDetails %}

    {# Define the data object based on your uploaded file structure #}
    {% set fundingData =  
        calculationresult
     %}

    {{ govukDetails({
      summaryText: "View Calculation Data (JSON)",
      html: "
        <p class='govuk-body-s'>This technical view shows the calculation hierarchy for " + fundingData.specification.name + ".</p>
        <pre style='background: #f3f2f1; padding: 15px; overflow-x: auto; border: 1px solid #b1b4b6; font-size: 14px; line-height: 1.2;'><code>" + (fundingData | dump(2)) + "</code></pre>
      "
    }) }}
    {# --- END OF JSON DETAILS COMPONENT --- #}

  </div>
</div>
{% endblock %}